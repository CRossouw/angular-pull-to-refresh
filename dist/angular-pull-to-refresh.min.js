/**
 * angular-pull-to-refresh
 * @version v0.3.0 - 2015-11-26
 * @link https://github.com/mgcrea/angular-pull-to-refresh
 * @author Olivier Louvignes <olivier@mg-crea.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
!function(a,b,c){"use strict";angular.module("mgcrea.pullToRefresh",[]).constant("pullToRefreshConfig",{treshold:60,debounce:400,text:{pull:"pull to refresh",release:"release to refresh",loading:"refreshing..."},icon:{pull:"fa fa-arrow-down",release:"fa fa-arrow-up",loading:"fa fa-refresh fa-spin"}}).directive("pullToRefresh",["$compile","$timeout","$q","pullToRefreshConfig",function(b,c,d,e){return{scope:{pullToRefreshConfig:"="},restrict:"A",transclude:!0,templateUrl:"angular-pull-to-refresh.tpl.html",compile:function(b,f,g){return function(b,f,g){function h(a){if(p)return{};var b="translateY("+a+"px)";return{"-webkit-transform":b,transform:b}}function i(a){var b=a;return b.originalEvent&&(b=b.originalEvent),b.touches[0]}var j=angular.extend({},e,b.pullToRefreshConfig,g),k=f.parent(),l=a.ptr=f.children()[0];b.text=j.text,b.icon=j.icon,b.status="pull";var m,n=function(a){o="release"===a,b.$apply(function(){b.status=a})},o=!1,p=!0;f.bind("touchstart",function(a){m=i(a).pageY}),f.bind("touchmove",function(a){var b=k[0].scrollTop,c=i(a).pageY;0===b&&(p=!1,b=m-c),f.css(h(c-m)),b<-j.treshold&&!o?n("release"):b>-j.treshold&&o&&n("pull")}),f.bind("touchend",function(a){if(o){f.css(h(0)),l.style.webkitTransitionDuration=0,l.style.margin="0 auto",n("loading");var e=+new Date;d.when(b.$eval(g.pullToRefresh)).then(function(){var a=+new Date-e;c(function(){l.style.margin="",l.style.webkitTransitionDuration="",b.status="pull"},a<j.debounce?j.debounce-a:0)})}}),b.$on("$destroy",function(){f.unbind("touchmove"),f.unbind("touchend")})}}}}]),angular.module("mgcrea.pullToRefresh").run(["$templateCache",function(a){a.put("angular-pull-to-refresh.tpl.html",'<div class="pull-to-refresh">\n  <i ng-class="icon[status]"></i>&nbsp;\n  <span ng-bind="text[status]"></span>\n</div>\n<div ng-transclude></div>\n')}])}(window,document);